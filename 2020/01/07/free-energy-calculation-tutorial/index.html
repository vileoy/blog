<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Free Energy Calculation Tutorial - vileoy&#039;s blog</title><link rel="manifest" href="/blog/manifest.json"><meta name="application-name" content="vileoy&#039;s blog"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-21-favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="vileoy&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="A common question in computational chemistry with relation to computer aided drug design is to estimate the differences in binding free energies of a series of small molecules (ligands) to a given tar"><meta property="og:type" content="blog"><meta property="og:title" content="Free Energy Calculation Tutorial"><meta property="og:url" content="https://vileoy.uovie.com/blog/2020/01/07/free-energy-calculation-tutorial/"><meta property="og:site_name" content="vileoy&#039;s blog"><meta property="og:description" content="A common question in computational chemistry with relation to computer aided drug design is to estimate the differences in binding free energies of a series of small molecules (ligands) to a given tar"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-nz9lw0.jpg"><meta property="article:published_time" content="2020-01-07T14:45:27.000Z"><meta property="article:modified_time" content="2020-10-29T03:36:42.865Z"><meta property="article:author" content="Haoyu Lin"><meta property="article:tag" content="Free Energy"><meta property="article:tag" content="Tutorial"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-nz9lw0.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://vileoy.uovie.com/blog/2020/01/07/free-energy-calculation-tutorial/"},"headline":"vileoy's blog","image":["https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-nz9lw0.jpg"],"datePublished":"2020-01-07T14:45:27.000Z","dateModified":"2020-10-29T03:36:42.865Z","author":{"@type":"Person","name":"Haoyu Lin"},"description":"A common question in computational chemistry with relation to computer aided drug design is to estimate the differences in binding free energies of a series of small molecules (ligands) to a given tar"}</script><link rel="canonical" href="https://vileoy.uovie.com/blog/2020/01/07/free-energy-calculation-tutorial/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-21-favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/blog/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/blog/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-0-logo.png" alt="vileoy&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/blog/">Home</a><a class="navbar-item" href="/blog/archives">Archives</a><a class="navbar-item" href="/blog/categories">Categories</a><a class="navbar-item" href="/blog/tags">Tags</a><a class="navbar-item" href="/blog/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/vileoy"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-nz9lw0.jpg" alt="Free Energy Calculation Tutorial"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-01-07T14:45:27.000Z" title="2020-01-07T14:45:27.000Z">2020-01-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-10-29T03:36:42.865Z" title="2020-10-29T03:36:42.865Z">2020-10-29</time></span><span class="level-item"><a class="link-muted" href="/blog/categories/Molecular-Dynamics/">Molecular Dynamics</a><span> / </span><a class="link-muted" href="/blog/categories/Molecular-Dynamics/Free-Energy-Calculation/">Free Energy Calculation</a></span><span class="level-item">19 minutes read (About 2840 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Free Energy Calculation Tutorial</h1><div class="content"><p>A common question in computational chemistry with relation to computer aided drug design is to estimate the differences in binding free energies of a series of small molecules (ligands) to a given target compound. When you first fall into the field, things seem not as easy as you think. Usually, the setup for calculation spends plenty of your time. This tutorial will take you through the way of free energy simulations in detail. Have a nice journey!</p>
<a id="more"></a>
<h2 id="requirements">Requirements</h2>
<h3 id="software">Software</h3>
<p>There are some necessary software to carry out the free energy calculation, please install them correctly.</p>
<h4 id="gromacs">GROMACS</h4>
<ul>
<li><p>Resources: <a target="_blank" rel="noopener" href="http://www.gromacs.org/">web</a>, <a target="_blank" rel="noopener" href="http://manual.gromacs.org/documentation/">pkg &amp; doc</a>.</p></li>
<li><p>Installation:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ tar xf gromacs-2020.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> gromacs-2020</span><br><span class="line">$ mkdir build</span><br><span class="line">$ <span class="built_in">cd</span> build</span><br><span class="line">$ cmake .. -DGMX_BUILD_OWN_FFTW=ON -DREGRESSIONTEST_DOWNLOAD=ON</span><br><span class="line">$ make</span><br><span class="line">$ make check</span><br><span class="line">$ sudo make install</span><br><span class="line">$ ln -s ../gromacs/bin/GMXRC bin/GMXRC</span><br></pre></td></tr></table></figure></li>
<li><p>Issues:</p>
<ol type="1">
<li>Set Installation Location</li>
</ol>
<p><code>-DCMAKE_INSTALL_PREFIX=xxx</code> to install GROMACS to a non-standard location.</p>
<ol start="2" type="1">
<li>CMake Error</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMake Error at cmake/gmxManageSimd.cmake:51 (message):</span><br><span class="line">  Cannot find AVX2 compiler flag. Use a newer compiler, or choose AVX SIMD</span><br></pre></td></tr></table></figure>
<p>Solution: Add <code>-DGMX_SIMD=AVX_256</code> as cmake option.</p>
<ol start="3" type="1">
<li>Offline Make</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- Downloading...</span><br><span class="line">   dst=<span class="string">&#x27;/home/leoy/Documents/Software/gromacs-2020/build/src/external/build-fftw/fftwBuild-prefix/src/fftw-3.3.8.tar.gz&#x27;</span></span><br><span class="line">   timeout=<span class="string">&#x27;none&#x27;</span></span><br><span class="line">-- Using src=<span class="string">&#x27;http://www.fftw.org/fftw-3.3.8.tar.gz&#x27;</span></span><br><span class="line">-- Retrying...</span><br></pre></td></tr></table></figure>
<p>Solution: Download <code>fftw-3.3.8.tar.gz</code> manually, and move it to <code>dst</code> directory.</p></li>
</ul>
<h4 id="fesetup">FESetup</h4>
<ul>
<li><p>Resources: <a target="_blank" rel="noopener" href="https://github.com/CCPBioSim/fesetup">git</a>, <a target="_blank" rel="noopener" href="http://www.ccpbiosim.ac.uk/software">pkg</a>, <a target="_blank" rel="noopener" href="https://fesetup.readthedocs.io/">doc</a>, <a target="_blank" rel="noopener" href="http://dx.doi.org/10.1021/acs.jcim.5b00368">doi</a>.</p></li>
<li><p>Installation: Here shows a successful installation example.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ ./FESetup1.2.1_Linux.sh</span><br><span class="line"></span><br><span class="line">Installing package FESetup release 1.2.1...</span><br><span class="line"></span><br><span class="line">Determining system environment...    found Linux x86_64/64</span><br><span class="line"></span><br><span class="line">===========================  installation setup ===========================</span><br><span class="line"></span><br><span class="line">The installer will now ask <span class="keyword">for</span> the installation directories of various MD</span><br><span class="line">software packages and <span class="keyword">for</span> the location of the Python 2.7 interpreter. All</span><br><span class="line">options either have defaults (<span class="keyword">in</span> brackets like <span class="string">&quot;[python]&quot;</span>) or are optional.</span><br><span class="line">You can change this at any time later by editing the script</span><br><span class="line">FESetup1.2.1/FESetup64/bin/FESetup.</span><br><span class="line"></span><br><span class="line">Confirm defaults by pressing the Enter key.</span><br><span class="line"></span><br><span class="line">This installer comes with all required AmberTools built <span class="keyword">in</span> but you can</span><br><span class="line">choose to point <span class="variable">$AMBERHOME</span> to your own installation.  It is _strongly_</span><br><span class="line">recommended, however, that you use the installer\<span class="string">&#x27;s default as otherwise</span></span><br><span class="line"><span class="string">you would have to make several modifications to the original installation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$AMBERHOME is preset to /usr/local/amber18, do you _really_ wish to use this? [y/N]</span></span><br><span class="line"><span class="string">Internal AMBER installation (press Enter) or type alternative [$FES_HOME/amber16]:</span></span><br><span class="line"><span class="string">GROMACS appears to be installed in /usr/local/gromacs, do you wish to use this? [Y/n]</span></span><br><span class="line"><span class="string">NAMD directory (path contains namd2) []:</span></span><br><span class="line"><span class="string">DL POLY directory (path contains execute/DLPOLY.Z) []:</span></span><br><span class="line"><span class="string">Python 2.7 interpreter executable [python]: python2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Checking if this is version 2.7...   found 2.7</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Creating directory FESetup1.2.1</span></span><br><span class="line"><span class="string">Verifying archive integrity... All good.</span></span><br><span class="line"><span class="string">Uncompressing FESetup release 1.2.1  100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">========== Installation of FESetup release 1.2.1 is now complete. ==========</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ ln -s ../FESetup1.2.1/FESetup64/bin/FESetup bin/FESetup</span></span><br></pre></td></tr></table></figure></li>
<li><p>Running: Executing the script FESetup needs an input file in INI format, otherwise it will perform a default task.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ FESetup [infile]</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="plumed">PLUMED</h4>
<ul>
<li><p>Resources: <a target="_blank" rel="noopener" href="https://www.plumed.org/">web</a>, <a target="_blank" rel="noopener" href="https://www.plumed.org//download.html">pkg</a>, <a target="_blank" rel="noopener" href="https://www.plumed.org//doc.html">doc</a>.</p></li>
<li><p>Installation: carry out the following commands to quickly install it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/<span class="built_in">local</span></span><br><span class="line">make -j 4</span><br><span class="line">make doc <span class="comment"># this is optional and requires proper doxygen version installed</span></span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>And next <a target="_blank" rel="noopener" href="https://www.plumed.org/doc-v2.5/user-doc/html/_installation.html#Patching">patch</a> the MD code.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /md/root/dir</span><br><span class="line">plumed patch -p</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="pymbar">pymbar</h4>
<ul>
<li><p>Resources: <a target="_blank" rel="noopener" href="https://github.com/choderalab/pymbar">git</a>, <a target="_blank" rel="noopener" href="https://pypi.org/project/pymbar/">pkg</a>, <a target="_blank" rel="noopener" href="https://pymbar.readthedocs.io/en/latest/">doc</a>.</p></li>
<li><p>Installation: choose one of the following command to install it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ conda install -c omnia pymbar</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install pymbar</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install git+https://github.com/choderalab/pymbar.git</span><br></pre></td></tr></table></figure></li>
<li><p>Notice: In our subsequent procedures, the <a target="_blank" rel="noopener" href="https://github.com/MobleyLab/alchemical-analysis/blob/master/alchemical_analysis/alchemical_analysis.py">alchemical_analysis.py</a> script written in Python 2 is needed, so change to Python 2 environment when install pymbar module.</p></li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<h3 id="preparation">Preparation</h3>
<p>First using FESetup to setup Lysozyme ligands with equilibration. In order to obtain the tutorial files please click <a target="_blank" rel="noopener" href="https://siremol.org/tutorials/somd/Binding_free_energy/Data/FESetup.zip">here</a>. We will look at the following example perturbations, i.e. benzene to o-xylene:</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/benzene~o-xylene.png" alt="" /><figcaption>benzene~o-xylene</figcaption>
</figure>
<p>Let’s start by creating a tutorial directory and place the unzipped <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lJaaJYtiQYMVU-MoEzXd1g">input file</a> (key: jh0r) into that directory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p Free_Energy/ins/Tutorial</span><br><span class="line">$ <span class="built_in">cd</span> Free_Energy/ins/Tutorial</span><br><span class="line">$ mv /path/to/input.zip .</span><br><span class="line">$ unzip input.zip</span><br></pre></td></tr></table></figure>
<p>The FESetup directory should have the following content:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls FESetup</span><br><span class="line">ligands  morph.in proteins  setup.in</span><br></pre></td></tr></table></figure>
<p>We now also have a directory with ligands. The coordinates of the ligands and that of the protein need to be in the same reference frame, i.e. the ligands need to fit into the binding pocket. Using VMD this can easily be double checked.</p>
<h4 id="fesetup-files-explained">FESetup files explained</h4>
<p>The <code>setup.in</code> file contains again all the necessary directives to set up the protein and the two ligands as well as directives necessary for the relative free energy calculations. Let’s look at some of the parts in more detail.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[globals]</span><br><span class="line">logfile &#x3D; T4-lysozyme.log</span><br><span class="line">forcefield &#x3D; amber, ff14SB, tip3p, hfe</span><br><span class="line">gaff &#x3D; gaff2</span><br><span class="line">AFE.type &#x3D; gromacs</span><br><span class="line">AFE.separate_vdw_elec &#x3D; false</span><br><span class="line">mdengine &#x3D; gromacs, mdrun</span><br><span class="line"></span><br><span class="line">[ligand]</span><br><span class="line">basedir &#x3D; ligands</span><br><span class="line">file.name &#x3D; ligand.mol2</span><br><span class="line">box.type &#x3D; rectangular</span><br><span class="line">box.length &#x3D; 12.0</span><br><span class="line">neutralize &#x3D; False </span><br><span class="line">min.nsteps &#x3D; 100</span><br><span class="line">molecules &#x3D; benzol, o-xylene</span><br><span class="line"></span><br><span class="line">min.nsteps &#x3D; 200</span><br><span class="line">min.ncyc &#x3D; 100</span><br><span class="line">min.restr_force &#x3D; 10.0</span><br><span class="line">min.restraint &#x3D; notsolvent</span><br><span class="line"></span><br><span class="line">[protein]</span><br><span class="line">basedir &#x3D; proteins</span><br><span class="line">molecules &#x3D; 181L</span><br><span class="line">propka &#x3D; t</span><br><span class="line"></span><br><span class="line">[complex]</span><br><span class="line"># explicit enumeration of pairs, otherwise all-with-all creation</span><br><span class="line">pairs &#x3D; 181L : benzol, 181L : o-xylene</span><br><span class="line"></span><br><span class="line">box.type &#x3D; rectangular</span><br><span class="line">box.length &#x3D; 12.0</span><br><span class="line">align_axes &#x3D; True</span><br><span class="line">neutralize &#x3D; True</span><br><span class="line"></span><br><span class="line">min.nsteps &#x3D; 2000</span><br><span class="line">min.ncyc   &#x3D; 1000</span><br><span class="line">min.restr_force &#x3D; 10.0</span><br><span class="line">min.restraint &#x3D; :LIG</span><br></pre></td></tr></table></figure>
<p>We now have a section called <code>[ligand]</code> and a section called <code>[protein]</code>, which contains all the information for the ligand simulation setup. <code>basedir = ligands</code> and <code>file.name = ligand.mol2</code> tell FESetup to look in the directory ligands for filenames <code>ligand.mol2</code>. Looking into this directory, you find two further directories name <code>benzol</code> and <code>o-xylene</code>, which are the two molecules for which we want to compute relative binding free energies. The <code>[ligand]</code> section with the box information will ensure that each ligand is parametrised using the generalised amber forcefield (GAFF), neutralised and minimised. The parameter <code>AFE.type = gromacs</code>, sets the output to be compatible with a SOMD free energy calculation, however AMBER and Sire output formats are also supported. Respectively <code>[protein]</code> contains all information regarding the protein to be setup with the ligand.</p>
<h4 id="running-fesetup-with-equilibration">Running FESetup with equilibration</h4>
<p>FESetup is run in the following way:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ FESetup setup.in</span><br></pre></td></tr></table></figure>
<blockquote>
<p>If you want to run programs on the cluster managed by Slurm which may prevent you from working on the management node, then you should apply for a computation node, log into it, and execute there. Here shows an example on the bibdr cluster:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ salloc -N 1 -p GPUV100 -n 4 --gres=gpu:1 --mem=16G</span><br><span class="line">$ ssh gpu06</span><br><span class="line">$ do_something</span><br><span class="line">$ <span class="built_in">exit</span> &amp;&amp; <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>The output generated with FESetup should look something like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">=== FESetup release 1.2.1, SUI version: 0.8.3 ===</span><br><span class="line"></span><br><span class="line">Please cite: HH Loeffler, J Michel, C Woods, J Chem Inf Mod, 55, 2485</span><br><span class="line">             DOI 10.1021/acs.jcim.5b00368</span><br><span class="line">For more information please visit http://www.ccpbiosim.ac.uk/fesetup/</span><br><span class="line"></span><br><span class="line">Making biomolecule 181L...</span><br><span class="line">Making ligand benzol...</span><br><span class="line">Making ligand o-xylene...</span><br><span class="line">Making complex from 181L and benzol...</span><br><span class="line">Making complex from 181L and o-xylene...</span><br><span class="line"></span><br><span class="line">=== All molecules built successfully ===</span><br></pre></td></tr></table></figure>
<p>After running the above <code>setup.in</code> file through FESetup all the required output files are generated. The FESetup directory should now look like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_complexes  _ligands  ligands  morph.in  _proteins  proteins  setup.in  T4-lysozyme.log</span><br></pre></td></tr></table></figure>
<p>First of all the logfile <code>T4-lysozyme.log</code> contains all GROMACS Tools commands executed to parameterise and setup the ligands and protein separately and in complex. <code>_proteins</code> contains the solvated and minimised protein file. <code>_ligands</code> contains the parameterised ligands solvated in a water box and in vacuum. Up to this point we can just run box standard molecular dynamics simulations of a protein with two different ligands bound. The necessary data for this can be found in <code>_complexes</code>. In order to actually do an alchemical free energy calculations we need to generate a set of perturbations. This will be done with a separate morph file, called <code>morph.in</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">FE_type &#x3D; gromacs</span><br><span class="line">AFE.separate_vdw_elec &#x3D; False</span><br><span class="line"></span><br><span class="line">[globals]</span><br><span class="line">forcefield &#x3D; amber, ff14SB, tip3p</span><br><span class="line">gaff &#x3D; gaff2</span><br><span class="line">logfile &#x3D; dGmorph.log</span><br><span class="line"></span><br><span class="line">[ligand]</span><br><span class="line">basedir &#x3D; ligands</span><br><span class="line">file.name &#x3D; ligand.mol2</span><br><span class="line">box.type &#x3D; rectangular</span><br><span class="line"></span><br><span class="line">morph_pairs &#x3D; benzol &gt; o-xylene, </span><br><span class="line">	o-xylene &gt; benzol</span><br><span class="line"></span><br><span class="line">[protein]</span><br><span class="line">basedir &#x3D; proteins</span><br><span class="line">molecules &#x3D; 181L</span><br><span class="line">propka &#x3D; t</span><br><span class="line"></span><br><span class="line">[complex]</span><br><span class="line"># the following are required to create the morph in solution</span><br><span class="line">box.type &#x3D; rectangular</span><br></pre></td></tr></table></figure>
<p>FESetup is run a again as before:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ FESetup morph.in</span><br></pre></td></tr></table></figure>
<p>and the output will look something like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">=== FESetup release 1.2.1, SUI version: 0.8.3 ===</span><br><span class="line"></span><br><span class="line">Please cite: HH Loeffler, J Michel, C Woods, J Chem Inf Mod, 55, 2485</span><br><span class="line">             DOI 10.1021/acs.jcim.5b00368</span><br><span class="line">For more information please visit http://www.ccpbiosim.ac.uk/fesetup/</span><br><span class="line"></span><br><span class="line">Making biomolecule 181L...</span><br><span class="line">Morphs will be generated <span class="keyword">for</span> gromacs</span><br><span class="line">Morphing benzol to o-xylene...</span><br><span class="line">Morphing o-xylene to benzol...</span><br><span class="line">Creating complex 181L:benzol with ligand morph benzol~o-xylene...</span><br><span class="line">Creating complex 181L:o-xylene with ligand morph o-xylene~benzol...</span><br><span class="line"></span><br><span class="line">=== All molecules built successfully ===</span><br></pre></td></tr></table></figure>
<p>The output will have generated a directory called <code>_perturbations</code> that contains all the necessary input for running an alchemical relative free energy calculation, with perturbations ready in protein complex format as well as just the solvated ligands.</p>
<h4 id="fesetup-output">FESetup output</h4>
<p>Let’s take a closer look at the <code>_perturbations</code> directory, that contains all necessary files for the production run. So the overall directory/file structure in the directory should now look like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">_perturbations/</span><br><span class="line">└── gromacs</span><br><span class="line">    ├── benzol~o-xylene</span><br><span class="line">    │   ├── complex</span><br><span class="line">    │   │   ├── leap.log</span><br><span class="line">    │   │   ├── ligand_removed.pdb</span><br><span class="line">    │   │   ├── morph.gro</span><br><span class="line">    │   │   ├── morph.top</span><br><span class="line">    │   │   ├── pert.atp -&gt; ../pert.atp</span><br><span class="line">    │   │   ├── pert.itp -&gt; ../pert.itp</span><br><span class="line">    │   │   ├── _sol.mdp</span><br><span class="line">    │   │   ├── state0.parm7</span><br><span class="line">    │   │   ├── state0.pdb</span><br><span class="line">    │   │   ├── state0.rst7</span><br><span class="line">    │   │   ├── state1.parm7</span><br><span class="line">    │   │   ├── state1.pdb</span><br><span class="line">    │   │   └── state1.rst7</span><br><span class="line">    │   ├── leap.log</span><br><span class="line">    │   ├── mcs_map.pkl</span><br><span class="line">    │   ├── mcs.mol2</span><br><span class="line">    │   ├── MORPH0.frcmod</span><br><span class="line">    │   ├── MORPH0.mol2</span><br><span class="line">    │   ├── MORPH1.frcmod</span><br><span class="line">    │   ├── MORPH1.mol2</span><br><span class="line">    │   ├── morph.gro -&gt; state0.gro</span><br><span class="line">    │   ├── morph.top</span><br><span class="line">    │   ├── pert.atp</span><br><span class="line">    │   ├── pert.itp</span><br><span class="line">    │   ├── solvated</span><br><span class="line">    │   │   ├── leap.log</span><br><span class="line">    │   │   ├── ligand_removed.pdb</span><br><span class="line">    │   │   ├── morph.gro</span><br><span class="line">    │   │   ├── morph.top</span><br><span class="line">    │   │   ├── pert.atp -&gt; ../pert.atp</span><br><span class="line">    │   │   ├── pert.itp -&gt; ../pert.itp</span><br><span class="line">    │   │   ├── _sol.mdp</span><br><span class="line">    │   │   ├── state0.parm7</span><br><span class="line">    │   │   ├── state0.pdb</span><br><span class="line">    │   │   ├── state0.rst7</span><br><span class="line">    │   │   ├── state1.parm7</span><br><span class="line">    │   │   ├── state1.pdb</span><br><span class="line">    │   │   └── state1.rst7</span><br><span class="line">    │   ├── state0.atp</span><br><span class="line">    │   ├── state0.gro</span><br><span class="line">    │   ├── state0.itp</span><br><span class="line">    │   ├── state0.parm7</span><br><span class="line">    │   ├── state0.pdb</span><br><span class="line">    │   ├── state0.rst7</span><br><span class="line">    │   ├── state1.atp</span><br><span class="line">    │   ├── state1.gro</span><br><span class="line">    │   ├── state1.itp</span><br><span class="line">    │   ├── state1.parm7</span><br><span class="line">    │   ├── state1.pdb</span><br><span class="line">    │   ├── state1.rst7</span><br><span class="line">    │   └── _vac.mdp</span><br><span class="line">    └── o-xylene~benzol</span><br><span class="line">        ├── complex</span><br><span class="line">        │   ├── leap.log</span><br><span class="line">        │   ├── ligand_removed.pdb</span><br><span class="line">        │   ├── morph.gro</span><br><span class="line">        │   ├── morph.top</span><br><span class="line">        │   ├── pert.atp -&gt; ../pert.atp</span><br><span class="line">        │   ├── pert.itp -&gt; ../pert.itp</span><br><span class="line">        │   ├── _sol.mdp</span><br><span class="line">        │   ├── state0.parm7</span><br><span class="line">        │   ├── state0.pdb</span><br><span class="line">        │   ├── state0.rst7</span><br><span class="line">        │   ├── state1.parm7</span><br><span class="line">        │   ├── state1.pdb</span><br><span class="line">        │   └── state1.rst7</span><br><span class="line">        ├── leap.log</span><br><span class="line">        ├── mcs_map.pkl</span><br><span class="line">        ├── mcs.mol2</span><br><span class="line">        ├── MORPH0.frcmod</span><br><span class="line">        ├── MORPH0.mol2</span><br><span class="line">        ├── MORPH1.frcmod</span><br><span class="line">        ├── MORPH1.mol2</span><br><span class="line">        ├── morph.gro -&gt; state0.gro</span><br><span class="line">        ├── morph.top</span><br><span class="line">        ├── pert.atp</span><br><span class="line">        ├── pert.itp</span><br><span class="line">        ├── solvated</span><br><span class="line">        │   ├── leap.log</span><br><span class="line">        │   ├── ligand_removed.pdb</span><br><span class="line">        │   ├── morph.gro</span><br><span class="line">        │   ├── morph.top</span><br><span class="line">        │   ├── pert.atp -&gt; ../pert.atp</span><br><span class="line">        │   ├── pert.itp -&gt; ../pert.itp</span><br><span class="line">        │   ├── _sol.mdp</span><br><span class="line">        │   ├── state0.parm7</span><br><span class="line">        │   ├── state0.pdb</span><br><span class="line">        │   ├── state0.rst7</span><br><span class="line">        │   ├── state1.parm7</span><br><span class="line">        │   ├── state1.pdb</span><br><span class="line">        │   └── state1.rst7</span><br><span class="line">        ├── state0.atp</span><br><span class="line">        ├── state0.gro</span><br><span class="line">        ├── state0.itp</span><br><span class="line">        ├── state0.parm7</span><br><span class="line">        ├── state0.pdb</span><br><span class="line">        ├── state0.rst7</span><br><span class="line">        ├── state1.atp</span><br><span class="line">        ├── state1.gro</span><br><span class="line">        ├── state1.itp</span><br><span class="line">        ├── state1.parm7</span><br><span class="line">        ├── state1.pdb</span><br><span class="line">        ├── state1.rst7</span><br><span class="line">        └── _vac.mdp</span><br></pre></td></tr></table></figure>
<p>With all input files generated for the alchemical free energy calculations, we can now move to the production run.</p>
<h3 id="production-md">Production MD</h3>
<h4 id="file-and-directory-structure-setup">File and directory structure setup</h4>
<p>Enter into <code>_perturbations/gromacs/benzol~o-xylene/complex</code> directory. Then create a script named <code>fes-prep.sh</code>, and write in</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># FES Preparation</span></span><br><span class="line">gro=<span class="string">&quot;morph.gro&quot;</span></span><br><span class="line">top=<span class="string">&quot;morph.top&quot;</span></span><br><span class="line">base=<span class="string">&quot;_sol&quot;</span></span><br><span class="line"> </span><br><span class="line">nstates=11</span><br><span class="line">mkdir prod</span><br><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; nstates; i++ ))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	imdp=<span class="string">&quot;<span class="variable">$base</span>.<span class="variable">$i</span>.mdp&quot;</span></span><br><span class="line">	itpr=<span class="string">&quot;<span class="variable">$base</span>.<span class="variable">$i</span>.tpr&quot;</span></span><br><span class="line">	sed <span class="string">&#x27;s/%L%/&#x27;</span><span class="string">&quot;<span class="variable">$i</span>&quot;</span><span class="string">&#x27;/&#x27;</span> <span class="variable">$base</span>.mdp &gt; <span class="variable">$imdp</span></span><br><span class="line">	gmx grompp -f <span class="variable">$imdp</span> -c em.gro -p <span class="variable">$top</span> -o prod/<span class="variable">$itpr</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>Now, a folder <code>prod</code> is created, in which resides eleven <code>.tpr</code> files.</p>
<h4 id="production-runs">Production runs</h4>
<p>Under the PBS job scheduling environment, you can use the following <code>job0.pbs</code> script to run a simulation for the complex. And others are run in the similar way.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#PBS -q mix</span></span><br><span class="line"><span class="comment">#PBS -V</span></span><br><span class="line"><span class="comment">#PBS -S /bin/bash</span></span><br><span class="line"><span class="comment">#PBS -j oe</span></span><br><span class="line"><span class="comment">#PBS -N samp</span></span><br><span class="line"><span class="comment">#PBS -l nodes=1:ppn=1</span></span><br><span class="line"><span class="comment">#PBS -l walltime=1024:00:00</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;begin: <span class="subst">$(date +<span class="string">&quot;%D %T&quot;</span>)</span>&quot;</span></span><br><span class="line">gmx mdrun -deffnm outputs/_sol.0 -dhdl outputs/_sol.0.dhdl.xvg</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;end: <span class="subst">$(date +<span class="string">&quot;%D %T&quot;</span>)</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>In the Slurm job scheduling system, you can use <code>job0.slurm</code> script like this</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash -l</span></span><br><span class="line"><span class="comment">#SBATCH --job-name=samp</span></span><br><span class="line"><span class="comment">#SBATCH --partition all</span></span><br><span class="line"><span class="comment">#SBATCH --nodes 1</span></span><br><span class="line"><span class="comment">#SBATCH --gpus=1</span></span><br><span class="line"><span class="comment">#SBATCH --cpus-per-gpu=6</span></span><br><span class="line"><span class="comment">#SBATCH --mem=60G</span></span><br><span class="line"></span><br><span class="line">module load openmpi/3.1.4</span><br><span class="line">module load cuda/10.0</span><br><span class="line">module load cuDNN/v7.6forcuda10.0</span><br><span class="line">module load plumed/2.5.1</span><br><span class="line">module load gromacs/2018.3</span><br><span class="line"></span><br><span class="line">gmx mdrun -deffnm prod/_sol.0 -dhdl prod/_sol.0.dhdl.xvg</span><br></pre></td></tr></table></figure>
<p>The same procedures should also apply to the case of ligand in water, namely files locate at the <code>_perturbations/gromacs/benzol~o-xylene/solvated</code> path.</p>
<p>After MD simulation, a series of <code>*.dhdl.xvg</code> files come out, which will be used to compute the free energy difference in the next step.</p>
<h3 id="analysis">Analysis</h3>
<h4 id="thermodynamic-cycles">Thermodynamic cycles</h4>
<p>In order to compute a free energy of binding we make use of thermodynamic cycles.</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/therm-cycle.jpg" alt="" /><figcaption>Thermodynamic Cycle</figcaption>
</figure>
<p><em>Thermodynamic cycle for the relative free energy of binding for benzene and xylene.</em></p>
<p>The free energy of binding can be computed as the free energy difference of the alchemical transformation of the ligand bound to the protein and the ligand in solution, i.e. water. <span class="math display">\[
\Delta \Delta G_{\mathrm{bind}}=\Delta G_{\mathrm{bound}}-\Delta G_{\mathrm{sol}}
\]</span> The individual terms can be computed in different ways. Two common approaches are thermodynamic integration and multi state Bennet’s acceptance ration (MBAR). Here we use the MBAR method provided by pymbar.</p>
<h4 id="computing-a-free-energy-difference-with-pymbar">Computing a free energy difference with pymbar</h4>
<p>Copy the <code>_sol.$i.dhdl.xvg</code> files to <code>dhdl.$i.xvg</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir anal</span><br><span class="line">$ <span class="keyword">for</span> i <span class="keyword">in</span> `seq 0 10`; <span class="keyword">do</span> cp prod/_sol.<span class="variable">$i</span>.dhdl.xvg mkdir anal/dhdl.<span class="variable">$i</span>.xvg; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>Then invoke the <a target="_blank" rel="noopener" href="https://github.com/MobleyLab/alchemical-analysis/blob/master/alchemical_analysis/alchemical_analysis.py">alchemical_analysis.py</a> script to analysis these MD results (using env-py2):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ alchemical_analysis -d anal</span><br></pre></td></tr></table></figure>
<p>It will print the analysis results on screen and also save it to a <code>results.txt</code> file. The contents looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">------------ ---------------------   ...   --------------------- ---------------------</span><br><span class="line">   States           TI (kJ&#x2F;mol)      ...         BAR (kJ&#x2F;mol)         MBAR (kJ&#x2F;mol)</span><br><span class="line">------------ ---------------------   ...   --------------------- ---------------------</span><br><span class="line">   0 -- 1         0.339  +-  0.049   ...        0.204  +-  0.040      1.947  +-  0.030</span><br><span class="line">   1 -- 2        -2.071  +-  0.043   ...       -2.149  +-  0.032     -0.360  +-  0.018</span><br><span class="line">   2 -- 3        -2.935  +-  0.043   ...       -2.995  +-  0.030     -1.599  +-  0.014</span><br><span class="line">   3 -- 4        -3.272  +-  0.046   ...       -3.315  +-  0.029     -2.357  +-  0.013</span><br><span class="line">   4 -- 5        -3.307  +-  0.050   ...       -3.335  +-  0.030     -2.738  +-  0.013</span><br><span class="line">   5 -- 6        -3.012  +-  0.054   ...       -3.085  +-  0.030     -2.699  +-  0.015</span><br><span class="line">   6 -- 7        -2.183  +-  0.059   ...       -2.259  +-  0.031     -2.121  +-  0.017</span><br><span class="line">   7 -- 8        -0.588  +-  0.064   ...       -0.597  +-  0.033     -0.740  +-  0.022</span><br><span class="line">   8 -- 9         1.666  +-  0.074   ...        1.606  +-  0.041      1.892  +-  0.034</span><br><span class="line">   9 -- 10        3.890  +-  0.109   ...        4.019  +-  0.053      3.965  +-  0.055</span><br><span class="line">------------ ---------------------   ...   --------------------- ---------------------</span><br><span class="line">  Coulomb:      -11.474  +-  0.230   ...      -11.906  +-  0.112     -4.811  +-  0.110</span><br><span class="line">  vdWaals:        0.000  +-  0.120   ...        0.000  +-  0.000      0.000  +-  0.000</span><br><span class="line">    TOTAL:      -11.474  +-  0.259   ...      -11.906  +-  0.112     -4.811  +-  0.110</span><br></pre></td></tr></table></figure>
<h2 id="references">References</h2>
<ol type="1">
<li>https://siremol.org/tutorials/somd/Binding_free_energy/FESetup.html</li>
<li>https://github.com/chryswoods/siremol.org</li>
</ol>
</div><div class="article-licensing box"><div class="licensing-title"><p>Free Energy Calculation Tutorial</p><p><a href="https://vileoy.uovie.com/blog/2020/01/07/free-energy-calculation-tutorial/">https://vileoy.uovie.com/blog/2020/01/07/free-energy-calculation-tutorial/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Haoyu Lin</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-01-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2020-10-29</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/blog/tags/Free-Energy/">Free Energy</a><a class="link-muted mr-2" rel="tag" href="/blog/tags/Tutorial/">Tutorial</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=5eb624fd6fa8080012c68782&amp;product=sticky-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/alipay-qrcode.jpg" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wechat-qrcode.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/blog/2020/01/12/prepare-structures-for-use-in-computation/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Prepare Structures for Use in Computation</span></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "004a5e5bd21abcf3c5244dc6fd2e76f4",
            repo: "blog",
            owner: "vileoy",
            clientID: "7dc49be522b0781c0b39",
            clientSecret: "33315fe6f9dd14cf774f83d746e462de45ebdaeb",
            admin: ["vileoy"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 15,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://cdn.jsdelivr.net/gh/vileoy/source/images/avatar-kousei.jpg" alt="Haoyu Lin"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Haoyu Lin</p><p class="is-size-6 is-block">PhD Student</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Haidian, Beijing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/blog/archives"><p class="title">26</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/blog/categories"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/blog/tags"><p class="title">37</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/vileoy" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/vileoy"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Wechat" href="account:vileoy"><i class="fab fa-weixin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="E-Mail" href="mailto:vileoy@pku.edu.cn"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/vileoy"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/blog/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#requirements"><span class="level-left"><span class="level-item">1</span><span class="level-item">Requirements</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#software"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Software</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#gromacs"><span class="level-left"><span class="level-item">1.1.1</span><span class="level-item">GROMACS</span></span></a></li><li><a class="level is-mobile" href="#fesetup"><span class="level-left"><span class="level-item">1.1.2</span><span class="level-item">FESetup</span></span></a></li><li><a class="level is-mobile" href="#plumed"><span class="level-left"><span class="level-item">1.1.3</span><span class="level-item">PLUMED</span></span></a></li><li><a class="level is-mobile" href="#pymbar"><span class="level-left"><span class="level-item">1.1.4</span><span class="level-item">pymbar</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#getting-started"><span class="level-left"><span class="level-item">2</span><span class="level-item">Getting Started</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#preparation"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Preparation</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#fesetup-files-explained"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">FESetup files explained</span></span></a></li><li><a class="level is-mobile" href="#running-fesetup-with-equilibration"><span class="level-left"><span class="level-item">2.1.2</span><span class="level-item">Running FESetup with equilibration</span></span></a></li><li><a class="level is-mobile" href="#fesetup-output"><span class="level-left"><span class="level-item">2.1.3</span><span class="level-item">FESetup output</span></span></a></li></ul></li><li><a class="level is-mobile" href="#production-md"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Production MD</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#file-and-directory-structure-setup"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">File and directory structure setup</span></span></a></li><li><a class="level is-mobile" href="#production-runs"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">Production runs</span></span></a></li></ul></li><li><a class="level is-mobile" href="#analysis"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Analysis</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#thermodynamic-cycles"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">Thermodynamic cycles</span></span></a></li><li><a class="level is-mobile" href="#computing-a-free-energy-difference-with-pymbar"><span class="level-left"><span class="level-item">2.3.2</span><span class="level-item">Computing a free energy difference with pymbar</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#references"><span class="level-left"><span class="level-item">3</span><span class="level-item">References</span></span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/blog/js/toc.js" defer></script></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://uovie.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">UOVIE</span></span><span class="level-right"><span class="level-item tag">uovie.com</span></span></a></li><li><a class="level is-mobile" href="https://lkoit.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">LKOIT</span></span><span class="level-right"><span class="level-item tag">lkoit.com</span></span></a></li><li><a class="level is-mobile" href="https://chemairy.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Chemairy</span></span><span class="level-right"><span class="level-item tag">chemairy.com</span></span></a></li><li><a class="level is-mobile" href="https://fairy.dance" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Fairy Dance</span></span><span class="level-right"><span class="level-item tag">fairy.dance</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/11/24/introduction-to-graph-neural-networks/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/intro-gnn-cover.png" alt="图神经网络简介"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-11-24T08:47:29.035Z">2020-11-24</time></p><p class="title"><a href="/blog/2020/11/24/introduction-to-graph-neural-networks/">图神经网络简介</a></p><p class="categories"><a href="/blog/categories/Machine-Learning/">Machine Learning</a> / <a href="/blog/categories/Machine-Learning/Graph-Neural-Networks/">Graph Neural Networks</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/11/04/music-score-season-song/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4d31xg.jpg" alt="Music Score: Season Song"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-11-04T03:02:50.000Z">2020-11-04</time></p><p class="title"><a href="/blog/2020/11/04/music-score-season-song/">Music Score: Season Song</a></p><p class="categories"><a href="/blog/categories/Music/">Music</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/10/21/champs-kaggle-competition-predicting-scalar-coupling-constants/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-kwjor6.jpg" alt="Champs Kaggle Competition: Predicting Scalar Coupling Constants"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-10-21T06:58:37.360Z">2020-10-21</time></p><p class="title"><a href="/blog/2020/10/21/champs-kaggle-competition-predicting-scalar-coupling-constants/">Champs Kaggle Competition: Predicting Scalar Coupling Constants</a></p><p class="categories"><a href="/blog/categories/Molecular-Modeling/">Molecular Modeling</a> / <a href="/blog/categories/Molecular-Modeling/Molecular-Property-Prediction/">Molecular Property Prediction</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/10/09/computer-aided-synthesis-planning-a-brief-introduction/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-73v1x3.jpg" alt="Computer-Aided Synthesis Planning: A Brief Introduction"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-10-08T16:21:42.990Z">2020-10-09</time></p><p class="title"><a href="/blog/2020/10/09/computer-aided-synthesis-planning-a-brief-introduction/">Computer-Aided Synthesis Planning: A Brief Introduction</a></p><p class="categories"><a href="/blog/categories/Synthesis-Planning/">Synthesis Planning</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/10/09/message-passing-neural-networks/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4dk19g.jpg" alt="Message Passing Neural Networks"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-10-08T16:21:42.990Z">2020-10-09</time></p><p class="title"><a href="/blog/2020/10/09/message-passing-neural-networks/">Message Passing Neural Networks</a></p><p class="categories"><a href="/blog/categories/Machine-Learning/">Machine Learning</a> / <a href="/blog/categories/Machine-Learning/Graph-Neural-Networks/">Graph Neural Networks</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/categories/Chemoinformatics/"><span class="level-start"><span class="level-item">Chemoinformatics</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Chemoinformatics/Conventions/"><span class="level-start"><span class="level-item">Conventions</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Game/"><span class="level-start"><span class="level-item">Game</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/LaTeX/"><span class="level-start"><span class="level-item">LaTeX</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Machine-Learning/Graph-Neural-Networks/"><span class="level-start"><span class="level-item">Graph Neural Networks</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Machine-Learning/Reinforcement-Learning/"><span class="level-start"><span class="level-item">Reinforcement Learning</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Molecular-Dynamics/"><span class="level-start"><span class="level-item">Molecular Dynamics</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Molecular-Dynamics/Free-Energy-Calculation/"><span class="level-start"><span class="level-item">Free Energy Calculation</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Molecular-Modeling/"><span class="level-start"><span class="level-item">Molecular Modeling</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Molecular-Modeling/Molecular-Property-Prediction/"><span class="level-start"><span class="level-item">Molecular Property Prediction</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Molecular-Modeling/Scoring-Function/"><span class="level-start"><span class="level-item">Scoring Function</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Music/"><span class="level-start"><span class="level-item">Music</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Parallel-Programming/"><span class="level-start"><span class="level-item">Parallel Programming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Synthesis-Planning/"><span class="level-start"><span class="level-item">Synthesis Planning</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/blog/tags/Activation-Function/"><span class="tag">Activation Function</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Attention-Mechanism/"><span class="tag">Attention Mechanism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/BibTeX/"><span class="tag">BibTeX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Binding-Affinity/"><span class="tag">Binding Affinity</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/C-Thread-Library/"><span class="tag">C++ Thread Library</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Chrome/"><span class="tag">Chrome</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Conda/"><span class="tag">Conda</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/DOI/"><span class="tag">DOI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Dino/"><span class="tag">Dino</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Free-Energy/"><span class="tag">Free Energy</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Graph/"><span class="tag">Graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/ISBN/"><span class="tag">ISBN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Loss-Function/"><span class="tag">Loss Function</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Matplotlib/"><span class="tag">Matplotlib</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Message-Passing-Interface/"><span class="tag">Message Passing Interface</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Mol2/"><span class="tag">Mol2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Music-Score/"><span class="tag">Music Score</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Neural-Network/"><span class="tag">Neural Network</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Perturbation-Theory/"><span class="tag">Perturbation Theory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Protein%E2%88%92Ligand-Complex/"><span class="tag">Protein−Ligand Complex</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Python/"><span class="tag">Python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Q-Learning/"><span class="tag">Q-Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/R/"><span class="tag">R</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/RDKit/"><span class="tag">RDKit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Reinforcement-Learning/"><span class="tag">Reinforcement Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Retrosynthesis/"><span class="tag">Retrosynthesis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Route-Planning/"><span class="tag">Route Planning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/SSH/"><span class="tag">SSH</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Scalar-Coupling/"><span class="tag">Scalar Coupling</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Scoring-Function/"><span class="tag">Scoring Function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Structure-Preparation/"><span class="tag">Structure Preparation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Tripos/"><span class="tag">Tripos</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Tutorial/"><span class="tag">Tutorial</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Workflow/"><span class="tag">Workflow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/arXiv/"><span class="tag">arXiv</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/blog/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-0-logo.png" alt="vileoy&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2020 Haoyu Lin</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/vileoy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/blog/js/column.js"></script><script src="/blog/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/blog/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/blog/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/blog/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>