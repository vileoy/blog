<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Calculating Free Energy Differences Using Perturbation Theory - vileoy&#039;s blog</title><link rel="manifest" href="/blog/manifest.json"><meta name="application-name" content="vileoy&#039;s blog"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-21-favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="vileoy&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="Perturbation theory is one of the oldest and most useful, general techniques in applied mathematics. Its applications vary widely, and the free energy differences between to two similar systems can be"><meta property="og:type" content="blog"><meta property="og:title" content="Calculating Free Energy Differences Using Perturbation Theory"><meta property="og:url" content="https://vileoy.uovie.com/blog/2020/01/30/calculating-free-energy-differences-using-perturbation-theory/"><meta property="og:site_name" content="vileoy&#039;s blog"><meta property="og:description" content="Perturbation theory is one of the oldest and most useful, general techniques in applied mathematics. Its applications vary widely, and the free energy differences between to two similar systems can be"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4v2ky8.jpg"><meta property="article:published_time" content="2020-01-30T10:25:00.000Z"><meta property="article:modified_time" content="2020-10-29T03:35:38.977Z"><meta property="article:author" content="Haoyu Lin"><meta property="article:tag" content="Free Energy"><meta property="article:tag" content="Perturbation Theory"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4v2ky8.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://vileoy.uovie.com/blog/2020/01/30/calculating-free-energy-differences-using-perturbation-theory/"},"headline":"vileoy's blog","image":["https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4v2ky8.jpg"],"datePublished":"2020-01-30T10:25:00.000Z","dateModified":"2020-10-29T03:35:38.977Z","author":{"@type":"Person","name":"Haoyu Lin"},"description":"Perturbation theory is one of the oldest and most useful, general techniques in applied mathematics. Its applications vary widely, and the free energy differences between to two similar systems can be"}</script><link rel="canonical" href="https://vileoy.uovie.com/blog/2020/01/30/calculating-free-energy-differences-using-perturbation-theory/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-21-favicon.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/blog/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/blog/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-0-logo.png" alt="vileoy&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/blog/">Home</a><a class="navbar-item" href="/blog/archives">Archives</a><a class="navbar-item" href="/blog/categories">Categories</a><a class="navbar-item" href="/blog/tags">Tags</a><a class="navbar-item" href="/blog/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/vileoy"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4v2ky8.jpg" alt="Calculating Free Energy Differences Using Perturbation Theory"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-01-30T10:25:00.000Z" title="2020-01-30T10:25:00.000Z">2020-01-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-10-29T03:35:38.977Z" title="2020-10-29T03:35:38.977Z">2020-10-29</time></span><span class="level-item"><a class="link-muted" href="/blog/categories/Molecular-Dynamics/">Molecular Dynamics</a><span> / </span><a class="link-muted" href="/blog/categories/Molecular-Dynamics/Free-Energy-Calculation/">Free Energy Calculation</a></span><span class="level-item">14 minutes read (About 2058 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Calculating Free Energy Differences Using Perturbation Theory</h1><div class="content"><p>Perturbation theory is one of the oldest and most useful, general techniques in applied mathematics. Its applications vary widely, and the free energy differences between to two similar systems can be calculated through this method. It is precisely the approach that was followed by the pioneers of free energy perturbation (FEP) theory. FEP is not only the oldest but also one of the more useful, general-purpose strategies for calculating free energy differences. In this post, we shall focus on calculating Helmholtz free energies in the canonical ensemble by virtue of FEP method. Extension to other ensembles is fairly straightforward.</p>
<a id="more"></a>
<h2 id="the-perturbation-formalism">The Perturbation Formalism</h2>
<p>Let us start by considering an <span class="math inline">\(N\)</span>-particle reference system described by the Hamiltonian <span class="math inline">\(H_0 (\mathbf{x}, \mathbf{p})\)</span>, which is a function of <span class="math inline">\(3N\)</span> Cartesian coordinates, <span class="math inline">\(\mathbf{x}\)</span>, and their conjugated momenta <span class="math inline">\(\mathbf{p}\)</span>. We are interested in calculating the free energy difference between this system and the target system characterized by the Hamiltonian <span class="math inline">\(H_1 (\mathbf{x}, \mathbf{p}) = H_0 (\mathbf{x}, \mathbf{p}) + \Delta H (\mathbf{x}, \mathbf{p})\)</span>.</p>
<p>The difference in the Helmholtz free energy between the target and the reference systems, <span class="math inline">\(\Delta A\)</span>, can be written in terms of the ratio of the corresponding partition functions, <span class="math inline">\(Q_1\)</span> and <span class="math inline">\(Q_0\)</span>: <span class="math display">\[
\begin{aligned}
\Delta A &amp;= -\frac{1}{\beta} \ln \frac{Q_{1}}{Q_{0}} = -\frac{1}{\beta} \ln \frac{\iint \mathrm{d} \mathbf{x} \mathrm{d} \mathbf{p} \exp \left[-\beta H_{1}(\mathbf{x}, \mathbf{p})\right]}{\iint \mathrm{d} \mathbf{x} \mathrm{d} \mathbf{p} \exp \left[-\beta H_{0}(\mathbf{x}, \mathbf{p})\right]} \\
&amp;= -\frac{1}{\beta} \ln \frac{\iint \mathrm{d} \mathbf{x} \mathrm{d} \mathbf{p} \exp \left[-\beta H_{0} (\mathbf{x}, \mathbf{p})\right] \exp \left[-\beta \Delta H (\mathbf{x}, \mathbf{p})\right]}{\iint \mathrm{d} \mathbf{x} \mathrm{d} \mathbf{p} \exp \left[-\beta H_{0}\left(\mathbf{x}, \mathbf{p}\right)\right]}.
\end{aligned} \tag{1} \label{1}
\]</span> For the canonical ensemble of the reference systems, the probability density function of finding the reference system in a state defined by positions <span class="math inline">\(\mathbf{x}\)</span> and momenta <span class="math inline">\(\mathbf{p}\)</span> is exactly <span class="math display">\[
P_{0} (\mathbf{x}, \mathbf{p}) = \frac{\exp \left[-\beta H_{0} (\mathbf{x}, \mathbf{p})\right]}{\iint \mathrm{d} \mathbf{x} \mathrm{d} \mathbf{p} \exp \left[-\beta H_{0} (\mathbf{x}, \mathbf{p})\right]}. \tag{2} \label{2}
\]</span> With this definition, Eq. <span class="math inline">\(\eqref{1}\)</span> can be written compactly as <span class="math display">\[
\Delta A = -\frac{1}{\beta} \ln \iint \mathrm{d} \mathbf{x} \mathrm{d} \mathbf{p} P_{0} (\mathbf{x}, \mathbf{p}) \exp \left[-\beta \Delta H (\mathbf{x}, \mathbf{p})\right] = -\frac{1}{\beta} \ln \left\langle\exp \left[-\beta \Delta H (\mathbf{x}, \mathbf{p})\right]\right\rangle_{0}. \tag{3} \label{3}
\]</span> If we reverse the reference and the target systems, and repeat the same derivation, using the same convention for <span class="math inline">\(\Delta H\)</span> as before, we obtain <span class="math display">\[
\Delta A = \frac{1}{\beta} \ln \langle\exp \left[\beta \Delta H (\mathbf{x}, \mathbf{p})\right]\rangle_{1}. \tag{4} \label{4}
\]</span></p>
<h2 id="interpretation-of-the-free-energy-perturbation-equation">Interpretation of the Free Energy Perturbation Equation</h2>
<p>The formulas for free energy differences, Eq. <span class="math inline">\(\eqref{3}\)</span> and Eq. <span class="math inline">\(\eqref{4}\)</span>, are formally exact for any perturbation. This does not mean, however, that they can always be successfully applied. To appreciate the practical limits of the perturbation formalism, we return to the expressions Eq. <span class="math inline">\(\eqref{3}\)</span> and Eq. <span class="math inline">\(\eqref{4}\)</span>. Since <span class="math inline">\(\Delta A\)</span> is calculated as the average over a quantity that depends only on <span class="math inline">\(\Delta H\)</span>, this average can be taken over the probability distribution <span class="math inline">\(P_{0} (\Delta H)\)</span> instead of <span class="math inline">\(P_{0} (\mathbf{x}, \mathbf{p})\)</span>. Then, <span class="math inline">\(\Delta A\)</span> in Eq. <span class="math inline">\(\eqref{3}\)</span> can be expressed as a one-dimensional integral over energy difference <span class="math display">\[
\Delta A = -\frac{1}{\beta} \ln \int \exp (-\beta \Delta H) P_{0}(\Delta H) \mathrm{d} \Delta H. \tag{5} \label{5}
\]</span> If <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> were the functions of a sufficient number of identically distributed random variables, then <span class="math inline">\(\Delta H\)</span> would be Gaussian distributed, which is a consequence of <strong>the central limit theorem</strong>. In practice, the probability distribution <span class="math inline">\(P_{0} (\Delta H)\)</span> deviates somewhat from the ideal Gaussian case, but still has a ‘Gaussian-like’ shape. Even though <span class="math inline">\(P_{0} (\Delta H)\)</span> is only rarely an exact Gaussian, it is instructive to consider this case in more detail. If we substitute <span class="math display">\[
P_{0}(\Delta H) = \frac{1}{\sqrt{2 \pi} \sigma} \exp \left[-\frac{\left(\Delta H - \langle\Delta H\rangle_{0}\right)^{2}}{2 \sigma^{2}}\right], \ \text{where}\ \sigma^{2} = \langle\Delta H^2\rangle_{0} - \langle\Delta H\rangle_{0}^{2}. \tag{6} \label{6}
\]</span> into Eq. <span class="math inline">\(\eqref{3}\)</span>, we obtain <span class="math display">\[
\exp (-\beta \Delta A) = \frac{\exp \left[-\beta\left(\langle\Delta H\rangle_{0}-\frac{1}{2} \beta \sigma^{2}\right)\right]}{\sqrt{2 \pi} \sigma} \int \exp \left[-\frac{\left(\Delta H-\langle\Delta H\rangle_{0}-\beta \sigma^{2}\right)^{2}}{2 \sigma^{2}}\right] \mathrm{d} \Delta H. \tag{7} \label{7}
\]</span> <img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/interpretation-fep-probability-distribution.jpg" alt="Interpretation of FEP Probability Distribution" /></p>
<p>Comparing Eq. <span class="math inline">\(\eqref{6}\)</span> and Eq. <span class="math inline">\(\eqref{7}\)</span>, we note that <span class="math inline">\(\exp (-\beta \Delta H) P_{0}(\Delta H)\)</span> is a Gaussian, as is <span class="math inline">\(P_{0} (\Delta H)\)</span>, but is not normalized and shifted toward low <span class="math inline">\(\Delta H\)</span> by <span class="math inline">\(\beta \sigma^2\)</span>. This simple example clearly illustrates the limitations in the direct application of Eq. <span class="math inline">\(\eqref{5}\)</span>. If the perturbation is significant and such that the variance <span class="math inline">\(\sigma\)</span> is large, the low-<span class="math inline">\(\Delta H\)</span> tail of the integrand, marked with stripes in the above figure is poorly sampled with <span class="math inline">\(P_{0} (\Delta H)\)</span> and, therefore, is known with low statistical accuracy.</p>
<p>If <span class="math inline">\(P_{0} (\Delta H)\)</span> is Gaussian, there is, of course, no reason to carry out a numerical integration, since the integral in Eq. <span class="math inline">\(\eqref{7}\)</span> can be readily evaluated analytically. This yields <span class="math display">\[
\Delta A = \langle\Delta H\rangle_{0} - \frac{1}{2} \beta \sigma^{2}. \tag{8} \label{8}
\]</span></p>
<blockquote>
<p><strong>Gibbs–Bogoliubov Bounds on Free Energy</strong></p>
<p>Considering two spatial probability distribution functions, <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span>, on a space defined by <span class="math inline">\(N\)</span> particles. We can show that <span class="math display">\[
\int F \ln F \mathrm{d} \mathbf{z}-\int F \ln G \mathrm{d} \mathbf{z} \geq 0. \tag{9} \label{9}
\]</span> Then substitute <span class="math inline">\(P_{0} (\mathbf{x}, \mathbf{p})\)</span> and <span class="math inline">\(P_{1} (\mathbf{x}, \mathbf{p})\)</span> as <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span> into Eq. <span class="math inline">\(\eqref{9}\)</span>, it obtains <span class="math display">\[
\langle\Delta H\rangle_{1} \leq \Delta A \leq \langle\Delta H\rangle_{0} \tag{10} \label{10}
\]</span> The Gibbs–Bogoliubov inequalities set bounds on <span class="math inline">\(\Delta A\)</span> of <span class="math inline">\(\langle\Delta H\rangle_{0}\)</span> and <span class="math inline">\(\langle\Delta H\rangle_{1}\)</span>, which are easier a priori to estimate. These bounds are of considerable conceptual interest, but are rarely sufficiently tight to be helpful in practice.</p>
</blockquote>
<h2 id="cumulant-expansion-of-the-free-energy">Cumulant Expansion of the Free Energy</h2>
<p>In this section, we will expand the desired free energy <span class="math inline">\(\Delta A\)</span> in a series with respect to the small parameter <span class="math inline">\(\beta\)</span>. The basic idea of the derivation is the cumulant expansion in probability theory, which leads <span class="math display">\[
\Delta A = -\frac{1}{\beta} \ln \left\langle\exp \left[-\beta \Delta H (\mathbf{x}, \mathbf{p})\right]\right\rangle_{0} = \sum_{n=1}^{\infty} \frac{(-\beta)^{n-1}}{n!} \langle\Delta H^{n}\rangle_{\text{c}}. \tag{11} \label{11}
\]</span> The first four cumulants are called the mean, variance, skewness, and curtosis (or kurtosis) of the distribution, respectively, and are obtained from the moments as <span class="math display">\[
\begin{array}{l}{\langle\Delta H\rangle_{\text{c}} = \langle\Delta H\rangle_{0}} \\ {\langle\Delta H^{2}\rangle_{\text{c}} = \left\langle\Delta H^{2}\right\rangle_{0}-\langle\Delta H\rangle_{0}^{2}} \\ {\langle\Delta H^{3}\rangle_{\text{c}} = \left\langle\Delta H^{3}\right\rangle_{0}-3\left\langle\Delta H^{2}\right\rangle_{0}\langle\Delta H\rangle_{0} + 2\langle\Delta H\rangle_{0}^{3}} \\ {\langle\Delta H^{4}\rangle_{\text{c}} = \left\langle\Delta H^{4}\right\rangle_{0}-4\left\langle\Delta H^{3}\right\rangle_{0}\langle\Delta H\rangle_{0}-3\langle\Delta H\rangle_{0}^{2} + 12\left\langle\Delta H^{2}\right\rangle_{0}\langle\Delta H\rangle_{0}^{2}-6\langle\Delta H\rangle_{0}^{4}}\end{array} \tag{12} \label{12}
\]</span> As may be seen, the formulas for higher-order cumulants become more complicated. More importantly, they are increasingly difficult to estimate accurately from simulations. If the expansion is terminated after the second order, the free energy takes the form <span class="math display">\[
\Delta A = \langle\Delta H\rangle_{0}-\frac{\beta}{2}\left(\left\langle\Delta H^{2}\right\rangle_{0}-\langle\Delta H\rangle_{0}^{2}\right), \tag{13} \label{13}
\]</span> which is identical to Eq. <span class="math inline">\(\eqref{8}\)</span>. This means that the second-order perturbation theory is accurate for Gaussian probability distribution functions. In other words, truncating the expansion for <span class="math inline">\(\Delta A\)</span> at the second order is equivalent to replacing <span class="math inline">\(P_{0} (\Delta H)\)</span> by a Gaussian distribution with the same variance. This is a fundamental result because it forms the basis for many approximate methods for estimating free energies.</p>
<h2 id="dealing-with-large-perturbations">Dealing with Large Perturbations</h2>
<p>Note that using Eq. <span class="math inline">\(\eqref{3}\)</span> directly can be successful only if <span class="math inline">\(P_0 (\Delta H)\)</span> is a narrow function of <span class="math inline">\(\Delta H\)</span>. This difficulty in applying FEP theory can be circumvented through a simple stratification strategy, also often called staging. It relies on constructing several intermediate states between the reference and the target state such that <span class="math inline">\(P (\Delta H_{i})\)</span> for two consecutive states <span class="math inline">\(i\)</span> and <span class="math inline">\(i + 1\)</span> sampled at state <span class="math inline">\(i\)</span> is sufficiently narrow for the direct evaluation of the corresponding free energy difference, <span class="math inline">\(\Delta A_{i}\)</span>. Then, Eq. <span class="math inline">\(\eqref{3}\)</span> can be used serially to yield <span class="math inline">\(\Delta A\)</span>. If we construct <span class="math inline">\(N - 1\)</span> intermediate states then <span class="math display">\[
\Delta A = \sum_{i=0}^{N-1} \Delta A_{i} = -\frac{1}{\beta} \sum_{i=0}^{N-1} \ln \left\langle\exp \left(-\beta \Delta H_{i}\right)\right\rangle_{i}. \tag{14} \label{14}
\]</span> Intermediate states do not have to be physically meaningful, i.e., they do not have to correspond to systems that actually exist.</p>
<p>More generally, we can consider the Hamiltonian as a function of some parameter, <span class="math inline">\(\lambda\)</span>. Without loss of generality, we can choose <span class="math inline">\(0 \le \lambda \le 1\)</span>, such that <span class="math inline">\(\lambda = 0\)</span> and <span class="math inline">\(\lambda = 1\)</span> for the reference and target states, respectively. A simple choice for the dependence of the Hamiltonian on <span class="math inline">\(\lambda\)</span> is a linear function <span class="math display">\[
H (\lambda_{i}) = \lambda_{i} H_{1} + (1-\lambda_{i}) H_{0} = H_{0} + \lambda_{i} \Delta H, \tag{15} \label{15}
\]</span> which justifies calling λ a coupling parameter. If we create <span class="math inline">\(N - 1\)</span> intermediate states linking the reference and the target states such that <span class="math inline">\(\lambda_0 = 0\)</span> and <span class="math inline">\(\lambda_N = 1\)</span> then the change in the Hamiltonian, <span class="math inline">\(\Delta H_i\)</span>, between two consecutive states is given by <span class="math display">\[
\Delta H_{i} = H (\lambda_{i+1}) - H (\lambda_{i}) = (\lambda_{i+1} - \lambda_{i}) \Delta H = \Delta \lambda_{i} \Delta H, \tag{16} \label{16}
\]</span> where <span class="math inline">\(\Delta \lambda_{i} = \lambda_{i+1} − \lambda_{i}\)</span>, and the formula for the total free energy difference becomes <span class="math display">\[
\Delta A = -\frac{1}{\beta} \sum_{i=0}^{N-1} \ln \left\langle\exp \left(-\beta \Delta \lambda_{i} \Delta H\right)\right\rangle_{\lambda_{i}}. \tag{17} \label{17}
\]</span> Stratification is not specific to FEP – it is a universal strategy that improves the efficiency of many other methods for calculating free energies.</p>
<h2 id="alchemical-transformations">Alchemical Transformations</h2>
<h3 id="free-energies-of-binding">Free Energies of Binding</h3>
<p>The free energy of binding of two molecules, <span class="math inline">\(\Delta A_{\text{binding}}\)</span>, defined as the free energy difference between these molecules in the bound and the free, unbound states, can be determined experimentally through the measurement of binding constants using, for instance, BIAcore or microcalorimetry techniques. Computationally, it can be evaluated through directly transformation or thermodynamic cycles.</p>
<h4 id="absolute-binding-free-energy">Absolute Binding Free Energy</h4>
<figure>
<img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/thermodynamic-cycle-protein-ligand-absolute-binding-free-energy.jpg" alt="" /><figcaption>The thermodynamic cycle for the determination of protein-ligand absolute binding free energy.</figcaption>
</figure>
<p>In general, FEP cannot be used for calculating <span class="math inline">\(\Delta A_{\text{binding}}\)</span> directly, following the upper horizontal transformation. Considering that the lower horizontal transformation corresponds to a zero free energy change, annihilation of the ligand in the reference, free state – i.e., the left, vertical transformation, and in the bound state – i.e., the right, vertical transformation, yields the binding free energy: <span class="math inline">\(\Delta A_{\text{binding}} = \Delta A_{\text{annihilation,0}} - \Delta A_{\text{annihilation,1}}\)</span>. The contribution <span class="math inline">\(\Delta A_{\text{restrain}}\)</span> that appears in the reverse, lower horizontal transformation characterizes the loss of rotational and translational entropies due to restraining the position of the ligand.</p>
<h4 id="relative-binding-free-energy">Relative Binding Free Energy</h4>
<figure>
<img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/thermodynamic-cycle-protein-ligand-relative-binding-free-energy.jpg" alt="" /><figcaption>The thermodynamic cycle for the determination of protein-ligand relative binding free energy.</figcaption>
</figure>
<p>Instead of carrying the horizontal transformations, one can mutate the ligand in the free state – i.e., the left, vertical ‘alchemical transformation’, and in the bound state – i.e., the right, vertical ‘alchemical transformation.’ This yields the difference in the binding free energies: <span class="math inline">\(\Delta A_{\text{binding,B}} - \Delta A_{\text{binding,A}} = \Delta A_{\text{mutation,1}} - \Delta A_{\text{mutation,0}}\)</span>.</p>
<h2 id="references">References</h2>
<ol type="1">
<li>Ch. Chipot and A. Pohorille. <em>Free Energy Calculations: Theory and Applications in Chemistry and Biology</em>. Springer, Berlin, 2007.</li>
</ol>
</div><div class="article-licensing box"><div class="licensing-title"><p>Calculating Free Energy Differences Using Perturbation Theory</p><p><a href="https://vileoy.uovie.com/blog/2020/01/30/calculating-free-energy-differences-using-perturbation-theory/">https://vileoy.uovie.com/blog/2020/01/30/calculating-free-energy-differences-using-perturbation-theory/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Haoyu Lin</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-01-30</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2020-10-29</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/blog/tags/Free-Energy/">Free Energy</a><a class="link-muted mr-2" rel="tag" href="/blog/tags/Perturbation-Theory/">Perturbation Theory</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=5eb624fd6fa8080012c68782&amp;product=sticky-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/alipay-qrcode.jpg" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wechat-qrcode.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/blog/2020/02/29/python-package-source-and-its-mirrors/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Python Package Source and Its Mirrors</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blog/2020/01/27/matplotlib-3-1-cheat-sheet/"><span class="level-item">Matplotlib 3.1 Cheat Sheet</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.2/gitalk.css"><script src="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.2/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "39d20d16b821fe41a107657158ce332f",
            repo: "blog",
            owner: "vileoy",
            clientID: "7dc49be522b0781c0b39",
            clientSecret: "33315fe6f9dd14cf774f83d746e462de45ebdaeb",
            admin: ["vileoy"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 15,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://cdn.jsdelivr.net/gh/vileoy/source/images/avatar-kousei.jpg" alt="Haoyu Lin"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Haoyu Lin</p><p class="is-size-6 is-block">PhD Student</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Haidian, Beijing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/blog/archives"><p class="title">26</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/blog/categories"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/blog/tags"><p class="title">37</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/vileoy" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/vileoy"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Wechat" href="account:vileoy"><i class="fab fa-weixin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="E-Mail" href="mailto:vileoy@pku.edu.cn"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/vileoy"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/blog/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#the-perturbation-formalism"><span class="level-left"><span class="level-item">1</span><span class="level-item">The Perturbation Formalism</span></span></a></li><li><a class="level is-mobile" href="#interpretation-of-the-free-energy-perturbation-equation"><span class="level-left"><span class="level-item">2</span><span class="level-item">Interpretation of the Free Energy Perturbation Equation</span></span></a></li><li><a class="level is-mobile" href="#cumulant-expansion-of-the-free-energy"><span class="level-left"><span class="level-item">3</span><span class="level-item">Cumulant Expansion of the Free Energy</span></span></a></li><li><a class="level is-mobile" href="#dealing-with-large-perturbations"><span class="level-left"><span class="level-item">4</span><span class="level-item">Dealing with Large Perturbations</span></span></a></li><li><a class="level is-mobile" href="#alchemical-transformations"><span class="level-left"><span class="level-item">5</span><span class="level-item">Alchemical Transformations</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#free-energies-of-binding"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">Free Energies of Binding</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#absolute-binding-free-energy"><span class="level-left"><span class="level-item">5.1.1</span><span class="level-item">Absolute Binding Free Energy</span></span></a></li><li><a class="level is-mobile" href="#relative-binding-free-energy"><span class="level-left"><span class="level-item">5.1.2</span><span class="level-item">Relative Binding Free Energy</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#references"><span class="level-left"><span class="level-item">6</span><span class="level-item">References</span></span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/blog/js/toc.js" defer></script></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://uovie.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">UOVIE</span></span><span class="level-right"><span class="level-item tag">uovie.com</span></span></a></li><li><a class="level is-mobile" href="https://lkoit.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">LKOIT</span></span><span class="level-right"><span class="level-item tag">lkoit.com</span></span></a></li><li><a class="level is-mobile" href="https://chemairy.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Chemairy</span></span><span class="level-right"><span class="level-item tag">chemairy.com</span></span></a></li><li><a class="level is-mobile" href="https://fairy.dance" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Fairy Dance</span></span><span class="level-right"><span class="level-item tag">fairy.dance</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/11/24/introduction-to-graph-neural-networks/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/intro-gnn-cover.png" alt="图神经网络简介"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-11-24T08:47:29.035Z">2020-11-24</time></p><p class="title"><a href="/blog/2020/11/24/introduction-to-graph-neural-networks/">图神经网络简介</a></p><p class="categories"><a href="/blog/categories/Machine-Learning/">Machine Learning</a> / <a href="/blog/categories/Machine-Learning/Graph-Neural-Networks/">Graph Neural Networks</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/11/04/music-score-season-song/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4d31xg.jpg" alt="Music Score: Season Song"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-11-04T03:02:50.000Z">2020-11-04</time></p><p class="title"><a href="/blog/2020/11/04/music-score-season-song/">Music Score: Season Song</a></p><p class="categories"><a href="/blog/categories/Music/">Music</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/10/21/champs-kaggle-competition-predicting-scalar-coupling-constants/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-kwjor6.jpg" alt="Champs Kaggle Competition: Predicting Scalar Coupling Constants"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-10-21T06:58:37.360Z">2020-10-21</time></p><p class="title"><a href="/blog/2020/10/21/champs-kaggle-competition-predicting-scalar-coupling-constants/">Champs Kaggle Competition: Predicting Scalar Coupling Constants</a></p><p class="categories"><a href="/blog/categories/Molecular-Modeling/">Molecular Modeling</a> / <a href="/blog/categories/Molecular-Modeling/Molecular-Property-Prediction/">Molecular Property Prediction</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/10/09/computer-aided-synthesis-planning-a-brief-introduction/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-73v1x3.jpg" alt="Computer-Aided Synthesis Planning: A Brief Introduction"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-10-08T16:21:42.990Z">2020-10-09</time></p><p class="title"><a href="/blog/2020/10/09/computer-aided-synthesis-planning-a-brief-introduction/">Computer-Aided Synthesis Planning: A Brief Introduction</a></p><p class="categories"><a href="/blog/categories/Synthesis-Planning/">Synthesis Planning</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/blog/2020/10/09/message-passing-neural-networks/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/wallhaven-4dk19g.jpg" alt="Message Passing Neural Networks"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-10-08T16:21:42.990Z">2020-10-09</time></p><p class="title"><a href="/blog/2020/10/09/message-passing-neural-networks/">Message Passing Neural Networks</a></p><p class="categories"><a href="/blog/categories/Machine-Learning/">Machine Learning</a> / <a href="/blog/categories/Machine-Learning/Graph-Neural-Networks/">Graph Neural Networks</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/categories/Chemoinformatics/"><span class="level-start"><span class="level-item">Chemoinformatics</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Chemoinformatics/Conventions/"><span class="level-start"><span class="level-item">Conventions</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Game/"><span class="level-start"><span class="level-item">Game</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/LaTeX/"><span class="level-start"><span class="level-item">LaTeX</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Machine-Learning/Graph-Neural-Networks/"><span class="level-start"><span class="level-item">Graph Neural Networks</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Machine-Learning/Reinforcement-Learning/"><span class="level-start"><span class="level-item">Reinforcement Learning</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Molecular-Dynamics/"><span class="level-start"><span class="level-item">Molecular Dynamics</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Molecular-Dynamics/Free-Energy-Calculation/"><span class="level-start"><span class="level-item">Free Energy Calculation</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Molecular-Modeling/"><span class="level-start"><span class="level-item">Molecular Modeling</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/blog/categories/Molecular-Modeling/Molecular-Property-Prediction/"><span class="level-start"><span class="level-item">Molecular Property Prediction</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Molecular-Modeling/Scoring-Function/"><span class="level-start"><span class="level-item">Scoring Function</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/blog/categories/Music/"><span class="level-start"><span class="level-item">Music</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Parallel-Programming/"><span class="level-start"><span class="level-item">Parallel Programming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/Synthesis-Planning/"><span class="level-start"><span class="level-item">Synthesis Planning</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/blog/tags/Activation-Function/"><span class="tag">Activation Function</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Attention-Mechanism/"><span class="tag">Attention Mechanism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/BibTeX/"><span class="tag">BibTeX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Binding-Affinity/"><span class="tag">Binding Affinity</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/C-Thread-Library/"><span class="tag">C++ Thread Library</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Chrome/"><span class="tag">Chrome</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Conda/"><span class="tag">Conda</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/DOI/"><span class="tag">DOI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Dino/"><span class="tag">Dino</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Free-Energy/"><span class="tag">Free Energy</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Graph/"><span class="tag">Graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/ISBN/"><span class="tag">ISBN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Loss-Function/"><span class="tag">Loss Function</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Matplotlib/"><span class="tag">Matplotlib</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Message-Passing-Interface/"><span class="tag">Message Passing Interface</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Mol2/"><span class="tag">Mol2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Music-Score/"><span class="tag">Music Score</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Neural-Network/"><span class="tag">Neural Network</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Perturbation-Theory/"><span class="tag">Perturbation Theory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Protein%E2%88%92Ligand-Complex/"><span class="tag">Protein−Ligand Complex</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Python/"><span class="tag">Python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Q-Learning/"><span class="tag">Q-Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/R/"><span class="tag">R</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/RDKit/"><span class="tag">RDKit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Reinforcement-Learning/"><span class="tag">Reinforcement Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Retrosynthesis/"><span class="tag">Retrosynthesis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Route-Planning/"><span class="tag">Route Planning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/SSH/"><span class="tag">SSH</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Scalar-Coupling/"><span class="tag">Scalar Coupling</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Scoring-Function/"><span class="tag">Scoring Function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Structure-Preparation/"><span class="tag">Structure Preparation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Tripos/"><span class="tag">Tripos</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Tutorial/"><span class="tag">Tutorial</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Workflow/"><span class="tag">Workflow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/arXiv/"><span class="tag">arXiv</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/blog/"><img src="https://cdn.jsdelivr.net/gh/vileoy/source/images/uovie-icon-0-logo.png" alt="vileoy&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2020 Haoyu Lin</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/vileoy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/blog/js/column.js"></script><script src="/blog/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/blog/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/blog/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/blog/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>